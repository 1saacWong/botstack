<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>pictureframe</title>


    <style>
        body{
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color:#e3ff15;
            margin:0px;
        }
        #player{
            padding-top: 45px;
            padding-left: 150px;
            margin:0 auto;
            display:block;
        }
        #playlist{
            top:0;
            left:0;
            width:300px;
            position: fixed;
            padding-left:25px;
            padding-top:130px;
        }
        #playlist li{ background-color:#000; color:#FFF; list-style: none;padding: 15px; margin-top:2px; }
        #overlay{
            background-color: #FFF;
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            padding:50px;
            text-align: center;
            margin: 0 auto;
            width: 500px;
        }
        #overlay img{max-width:400px;}
        #overlay-wrapper{
            position: fixed;
            top: 0;left:0;bottom: 0;right:0;
            padding-top:200px;
        }
        #username{
            text-transform: uppercase;
            color: pink;
        }
        .activetrack{
            background-color:#000!important;
        }
        .header{background-color:#000;}
        .header img{width:150px;margin-left:50px;}
    </style>


</head>
<body>

<div id="player"></div>
<div id="playlist"></div>
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.3/jquery.backstretch.min.js"></script>
    <script>

    

      $( document ).ready(function() {
        $.getJSON( "/images", function( data ) {
            console.log(data)
          $("body").backstretch(data, {duration: 4000, fade: 750});
        });
    });

    var lastplaylistlength = 0;
    var tracks;
     function polltracks(){
        $.getJSON( "/images", function( data ) {
            var items = [];
            tracks = []
            console.log(data);
            $.each( data, function( key, val ) {
                tracks.push(val);
            });
            if (lastplaylistlength < data.length){
                showOverlay();
            }
            lastplaylistlength = data.length
            var instance = $('body').data('backstretch');
            instance.images = data;
        });
    }
    $(function() {
        // Handler for .ready() called.
        $("#overlay>img").hide();
        $("#overlay-wrapper").hide();
        
    });
    setInterval(function(){ polltracks(); }, 3000);

var timeout;
    function showOverlay(){
        $("#overlay-wrapper").show();
        $("#overlay>img").hide();
        rnd = getRandomIntInclusive(1,7);
        activetrack = tracks[tracks.length-1];
        $("#successimage"+rnd).show();
        clearTimeout(timeout);
        timeout = setTimeout(function(){ $("#overlay-wrapper").hide(); }, 3000);
    }

     function getRandomIntInclusive(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }


    </script>


<div id="overlay-wrapper">
    <div id="overlay" >
        <h1>THANK YOU FOR THIS IMAGE</h1>
        <img id="successimage1" src="https://media.giphy.com/media/z9lZMI5UDdI08/giphy.gif">
        <img id="successimage2" src="https://media.giphy.com/media/11W37uI72pjDkk/giphy.gif">
        <img id="successimage3" src="https://66.media.tumblr.com/tumblr_lrdz2ae6961qhgpbqo1_500.gif">
        <img id="successimage4" src="https://media.giphy.com/media/aUhEBE0T8XNHa/giphy.gif">
        <img id="successimage5" src="http://i.imgur.com/ovy5dPv.gif">
        <img id="successimage6" src="http://www.thedailycrate.com/wp-content/uploads/2014/01/Blog-DJ-Spinny.gif">
        <img id="successimage7" src="http://24.media.tumblr.com/77927c3e8ecebf5b5799690db48ea196/tumblr_mqyxj66BZF1qfkjeho1_500.gif">


    </div>
</div>


</body>
</html>